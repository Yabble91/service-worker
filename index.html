<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			.boxImg {
				width: 400px;
				height: 400px;
			}
		</style>
		<link rel="stylesheet" href="./main.css">
		<script type="text/javascript" src="./JQuery3.2.2.js"></script>
	</head>
	<body>
		<div id="" class="box1">
			<img class="boxImg" src="./main.jpg"/>
			<p id="cur_txt">当前注册状态：<span id="cur_status"></span></p>
			<p id="sw_txt">当前sw状态：<span id="sw_status"></span></p>
			<button type="button" name="button" id="btn1">点击获取图片fetch</button>
			<button type="button" name="button" id="btn2">点击获取图片ajax</button>
			<button type="button" name="button" id="btn3">点击访问接口ajax</button>
		</div>
		<script type="text/javascript">
			var curTxt = document.querySelector('#cur_txt');
			var curStatus = document.querySelector('#cur_status');
			var swTxt = document.querySelector('#sw_txt');
			var swStatus = document.querySelector('#sw_status');
			var btn1 = document.querySelector('#btn1');
			var btn2 = document.querySelector('#btn2');
			var btn3 = document.querySelector('#btn3');
			if ('serviceWorker' in navigator) {
//				navigator.serviceWorker.register
				navigator.serviceWorker.register('./serviceWorkerStore.js').then(function (reg){
					var serviceWorkder;
					if (reg.installing) {
						serviceWorkder = reg.installing
						curStatus.innerText = '安装中'
					} else if (reg.waiting) {
						serviceWorkder = reg.waiting
						curStatus.innerText = '等待中'
					} else if (reg.active) {
						serviceWorkder = reg.active
						curStatus.innerText = '已激活'
					}
					if (serviceWorkder) {
						swStatus.innerText = serviceWorkder.state;
						serviceWorkder.addEventListener('statechange', function (e) {
							console.log('sw状态变化为', e.target.state);
						})
					}
				}).catch(function(err) {
					console.log('err is ', err)
				})
			}

			// 点击按钮1发起fetch请求
			btn1.onclick = () => {
				fetch('./cry.jpg').then(res => {
					console.log('fetch :', res)
				})
			}

			// 点击按钮2发起ajax请求
			btn2.onclick = () => {
				$.get('./cry.jpg', function (res) {
					console.log(res)
				})
			}

			// 点击按钮3发起ajax请求
			btn3.onclick = () => {
				$.get('https://www.baidu.com/his?wd=&from=pc_web&rf=3&hisdata=%5B%7B%22time%22%3A1546528599%2C%22kw%22%3A%22%E8%83%A1%E6%99%AE%E9%80%9A%22%7D%2C%7B%22time%22%3A1546528617%2C%22kw%22%3A%22%E5%B9%BF%E8%A5%BF%E6%9F%B3%E5%B7%9E%E7%88%B6%E6%9D%80%E5%A5%B3%E6%A1%88%22%7D%2C%7B%22time%22%3A1546528728%2C%22kw%22%3A%22%E5%9B%BD%E9%99%85%E7%A7%9F%E8%BD%A6%22%2C%22fq%22%3A2%7D%5D&json=1&p=3&sid=1468_21116_28206_28131_28140&req=2&bs=%E8%AF%BA%E8%89%BE%E5%B0%94&csor=0&cb=jQuery11020676606744705762_1546529160865&_=1546529160866', function (res) {
					console.log('ajax :', res)
				})
			}
		</script>
		<script type="text/javascript" src="./main.js"></script>
	</body>
</html>
